<div id="fullMainContent" @fadeInOut>
  <div class="container" *ngIf="!courseAdded; else whatNext">
    <div class="display-4 mb-5">
      Build a new course
    </div>

    <form [formGroup]="courseAddForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="title">Title</label>
        <input
          type="text"
          class="form-control col-12 col-lg-8"
          id="title"
          maxlength="128"
          formControlName="title"
          [class.border-danger]="
            courseAddForm.controls['title'].invalid && courseAddForm.controls['title'].touched
          "
          aria-describedby="titleHelp"
        >
        <small *ngIf="courseAddForm.controls['title'].touched" id="titleHelp" class="form-text text-danger">
          <span *ngIf="courseAddForm.controls['title'].errors?.required">
            Required.
          </span>
          <span *ngIf="courseAddForm.controls['title'].errors?.minlength">
            Must be 16 to 128 characters.
          </span>
          <span *ngIf="courseAddForm.controls['title'].errors?.pattern">
            Consecutive spaces are not accepted.
          </span>
        </small>
      </div>

      <div class="form-group">
        <label for="short_desc">Short description</label>
        <input
          type="text"
          class="form-control"
          id="short_desc"
          formControlName="short_desc"
          [class.border-danger]="
            courseAddForm.controls['short_desc'].invalid && courseAddForm.controls['short_desc'].touched
          "
          aria-describedby="short_descHelp"
        >
        <small id="short_descHelp" class="form-text text-muted">
          Used in catalogue directory and on course pages.
          <span *ngIf="courseAddForm.controls['short_desc'].touched" class="text-danger">
            <span *ngIf="courseAddForm.controls['short_desc'].errors?.required">
              Required.
            </span>
            <span *ngIf="courseAddForm.controls['short_desc'].errors?.minlength">
              Must be 32 to 256 characters.
            </span>
            <span *ngIf="courseAddForm.controls['short_desc'].errors?.pattern">
              Consecutive spaces are not accepted.
            </span>
          </span>
        </small>
      </div>

      <div class="form-group">
        <label for="price">Price</label>
        <div class="input-group mr-sm-2">
          <div class="input-group-prepend">
            <div class="input-group-text">$</div>
          </div>
          <input type="number" class="form-control col-4 col-md-3 col-lg-1" min="0" max="99999" id="price" formControlName="price"  aria-describedby="priceCurrency">
        </div>
        <small id="priceCurrency" class="form-text text-muted">Canadian Dollars</small>

      </div>

      <div class="form-group form-check my-2">
        <input type="checkbox" class="form-check-input" id="private" formControlName="private">
        <label for="private" class="form-check-label" aria-describedby="privateHelp">Private</label>
        <small id="privateHelp" class="form-text text-muted">Access-code access only; course will not show up in catalogues, and cannot be purchased.</small>
      </div>

      <div>
        <button mat-button color="primary" type="button" class="my-3 border" (click)="collapse.toggle()" [attr.aria-expanded]="hideAdvanced" aria-controls="collapseExample">
          <div class="text-uppercase">
            <span [innerHtml]="hideAdvanced ? 'Show' : 'Hide'"></span> <span> advanced</span>
          </div>
        </button>
      </div>

      <div #collapse="ngbCollapse" [(ngbCollapse)]="hideAdvanced">

        <div class="form-group">
          <label for="long_desc">Long description</label>
          <textarea class="form-control" id="long_desc" formControlName="long_desc" row="3" length="128" aria-describedby="long_descHelp"></textarea>
          <small id="long_descHelp" class="form-text text-muted">Used chiefly on course pages.</small>
        </div>

        <div class="form-group">
          <label for="audience">Audience</label>
          <input
            type="text"
            class="form-control col-12 col-lg-8"
            id="audience"
            maxlength="128"
            formControlName="audience"
            aria-describedby="audienceHelp"
          >
          <small id="audienceHelp" class="form-text text-muted">
            Who might benefit the most from this course?
            E.g. Business professionals looking to improve leadership skills.
          </small>
        </div>

        <div class="form-group">
          <label for="objective">Objectives</label>
          <textarea class="form-control" id="objective" formControlName="objective" row="2" length="128"></textarea>
        </div>

        <div class="form-group">
          <label for="eval_type">Evaluation type</label>
          <div>
            <select class="custom-select mr-sm-2 col-12 col-lg-8" id="eval_type" formControlName="eval_type">
              <option selected>Choose...</option>
              <option value="o">Online</option>
              <option value="i">Instructor</option>
              <option value="oi">Online & Instructor</option>
            </select>
          </div>
        </div>

      </div>

      <button type="submit" class="btn btn-primary my-4" [disabled]="!courseAddForm.valid">Submit</button>

    </form>

  </div>

  <ng-template #whatNext>
    <div class="container mt-5 lead" @fadeInOut>
      <div>
        <p>Added <span class="font-weight-bold">{{ courseAddForm.value.title }}</span> course.</p>
      </div>
      <div class="text-danger">
        Content builder still in development.
        <button
          type="button"
          class="btn btn-secondary d-block mb-5 mt-1"
          [disabled]="true"
        >
          Add content
        </button>
      </div>
      <div>
        Return to your
        <a
          [routerLink]="['/admin', 'publisher', 'courses']"
          type="button"
          class="text-info mt-5"
        >course directory</a>.
      </div>
    </div>
  </ng-template>

</div>
