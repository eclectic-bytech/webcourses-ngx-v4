{"version":3,"file":"449.7bcd479ab2bffaa2.js","mappings":"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","names":["Course","i0","CourseComponent","constructor","fb","httpClient","activatedRoute","router","_snackbar","courseService","configService","deleteCourseService","this","courseAddForm","group","title","Validators","short_desc","price","private","audience","long_desc","objective","eval_type","ngOnInit","cid","getAdminCourse","subscribe","course","patchValue","controls","onSubmit","waitingForApi","post","params","api","route","value","navigate","err","onUpdate","patch","snackbarNotify","deleteCourseBtn","deleteCourseModal","message","open","duration","snapshot","paramMap","get","static","core","selectors","ctx","FadeInOut","routes","path","component","CourseRoutingModule","RouterModule","CourseModule","CommonModule","ReactiveFormsModule","NgbModule","MatButtonModule","MatSnackBarModule"],"sourceRoot":"webpack:///","sources":["./src/app/models/course.model.ts","./src/app/pages/admin/builder/course/course.component.html","./src/app/pages/admin/builder/course/course.component.ts","./src/app/pages/admin/builder/course/course-routing.module.ts","./src/app/pages/admin/builder/course/course.module.ts"],"sourcesContent":["import { Publisher } from './publisher.model'\r\nimport { UserCourseProgress } from './user.course.progress.model'\r\n\r\nexport class Course {\r\n  public id: number\r\n  public title: string\r\n  public cover: string\r\n  public publisher_id: number\r\n  public completion_time: number\r\n  public audience: string\r\n  public cover_alt: string\r\n  public short_desc: string\r\n  public long_desc: string\r\n  public objective: string\r\n  public eval_type: string\r\n  public price: number\r\n  public created_at: string\r\n  public updated_at: string\r\n  public private: boolean\r\n  public published: boolean\r\n  public total_activities: number\r\n  public total_students: number\r\n  public publisher: Publisher\r\n  public user_progress?: UserCourseProgress\r\n  public access_codes?: number\r\n}\r\n","<div id=\"fullMainContent\" @fadeInOut>\r\n  <div class=\"container\">\r\n    <div class=\"display-4 my-5\" style=\"line-height: 3rem;\" *ngIf=\"cid; else newCourse\">\r\n      Update course<br>\r\n      <span class=\"h5\">{{ course.title }}</span>\r\n    </div>\r\n    <ng-template #newCourse>\r\n      <div class=\"display-4 my-5\">\r\n        Create a new course\r\n      </div>\r\n      <p class=\"lead\">Though you can create a course, the course builder is still in development.</p>\r\n      <p class=\"lead\">\r\n        Create a course today to lock in the discounted $5 / participant charge.<br>\r\n        The per participant charge on courses created after the builder launches is $7.\r\n      </p>\r\n      <p class=\"mb-5\">\r\n        <small class=\"text-dark\">\r\n          Flat fees are for courses priced at $50 or less.\r\n          Charges for courses priced higher are 10%, and 15% for courses created after builder launch.\r\n        </small>\r\n      </p>\r\n    </ng-template>\r\n\r\n    <form [formGroup]=\"courseAddForm\" (ngSubmit)=\"cid ? onUpdate() : onSubmit()\">\r\n      <div class=\"form-group\">\r\n        <label for=\"title\">Title</label>\r\n        <input\r\n          type=\"text\"\r\n          class=\"form-control col-12 col-lg-8\"\r\n          id=\"title\"\r\n          minLength=\"16\"\r\n          maxlength=\"128\"\r\n          formControlName=\"title\"\r\n          [class.border-danger]=\"\r\n            courseAddForm.controls['title'].invalid && courseAddForm.controls['title'].touched\r\n          \"\r\n          aria-describedby=\"titleHelp\"\r\n        >\r\n        <small *ngIf=\"courseAddForm.controls['title'].touched\" id=\"titleHelp\" class=\"form-text text-danger\">\r\n          <span *ngIf=\"courseAddForm.controls['title'].errors?.required\">\r\n            Required.\r\n          </span>\r\n          <span *ngIf=\"courseAddForm.controls['title'].errors?.minlength\">\r\n            Must be 16 to 128 characters.\r\n          </span>\r\n          <span *ngIf=\"courseAddForm.controls['title'].errors?.pattern\">\r\n            Consecutive spaces are not accepted.\r\n          </span>\r\n        </small>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"short_desc\">Short description</label>\r\n        <input\r\n          type=\"text\"\r\n          class=\"form-control\"\r\n          id=\"short_desc\"\r\n          minLength=\"32\"\r\n          maxLength=\"256\"\r\n          formControlName=\"short_desc\"\r\n          [class.border-danger]=\"\r\n            courseAddForm.controls['short_desc'].invalid && courseAddForm.controls['short_desc'].touched\r\n          \"\r\n          aria-describedby=\"short_descHelp\"\r\n        >\r\n        <small id=\"short_descHelp\" class=\"form-text text-muted\">\r\n          Used in catalogue directory and on course pages.\r\n          <span *ngIf=\"courseAddForm.controls['short_desc'].touched\" class=\"text-danger\">\r\n            <span *ngIf=\"courseAddForm.controls['short_desc'].errors?.required\">\r\n              Required.\r\n            </span>\r\n            <span *ngIf=\"courseAddForm.controls['short_desc'].errors?.minlength\">\r\n              Must be 32 to 256 characters.\r\n            </span>\r\n            <span *ngIf=\"courseAddForm.controls['short_desc'].errors?.pattern\">\r\n              Consecutive spaces are not accepted.\r\n            </span>\r\n          </span>\r\n        </small>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"price\">Price</label>\r\n        <div class=\"input-group mr-sm-2\">\r\n          <div class=\"input-group-prepend\">\r\n            <div class=\"input-group-text\">$</div>\r\n          </div>\r\n          <input type=\"number\" class=\"form-control col-4 col-md-3 col-lg-1\" min=\"0\" max=\"99999\" id=\"price\" formControlName=\"price\"  aria-describedby=\"priceCurrency\">\r\n        </div>\r\n        <small id=\"priceCurrency\" class=\"form-text text-muted\">Canadian Dollars</small>\r\n\r\n      </div>\r\n\r\n      <div class=\"form-group form-check my-2\">\r\n        <input type=\"checkbox\" class=\"form-check-input\" id=\"private\" formControlName=\"private\">\r\n        <label for=\"private\" class=\"form-check-label\" aria-describedby=\"privateHelp\">Private</label>\r\n        <small id=\"privateHelp\" class=\"form-text text-muted\">Access-code access only; course will not show up in catalogues, and cannot be purchased.</small>\r\n      </div>\r\n\r\n      <div>\r\n        <button mat-button color=\"primary\" type=\"button\" class=\"my-3 border\" (click)=\"collapse.toggle()\" [attr.aria-expanded]=\"hideAdvanced\" aria-controls=\"collapseExample\">\r\n          <div class=\"text-uppercase\">\r\n            <span [innerHtml]=\"hideAdvanced ? 'Show' : 'Hide'\"></span> <span> advanced</span>\r\n          </div>\r\n        </button>\r\n      </div>\r\n\r\n      <div #collapse=\"ngbCollapse\" [(ngbCollapse)]=\"hideAdvanced\">\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"long_desc\">Long description</label>\r\n          <textarea class=\"form-control\" id=\"long_desc\" formControlName=\"long_desc\" row=\"3\" length=\"128\" aria-describedby=\"long_descHelp\"></textarea>\r\n          <small id=\"long_descHelp\" class=\"form-text text-muted\">Used chiefly on course pages.</small>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"audience\">Audience</label>\r\n          <input\r\n            type=\"text\"\r\n            class=\"form-control col-12 col-lg-8\"\r\n            id=\"audience\"\r\n            maxlength=\"128\"\r\n            formControlName=\"audience\"\r\n            aria-describedby=\"audienceHelp\"\r\n          >\r\n          <small id=\"audienceHelp\" class=\"form-text text-muted\">\r\n            Who might benefit the most from this course?\r\n            E.g. Business professionals looking to improve leadership skills.\r\n          </small>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"objective\">Objectives</label>\r\n          <textarea class=\"form-control\" id=\"objective\" formControlName=\"objective\" row=\"2\" length=\"128\"></textarea>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"eval_type\">Evaluation type</label>\r\n          <div>\r\n            <select class=\"custom-select mr-sm-2 col-12 col-lg-8\" id=\"eval_type\" formControlName=\"eval_type\">\r\n              <option selected>Choose...</option>\r\n              <option value=\"Online\">Online</option>\r\n              <option value=\"Instructor\">Instructor</option>\r\n              <option value=\"Online + Instructor\">Online + Instructor</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <button\r\n        type=\"submit\"\r\n        class=\"btn my-4 mr-4\"\r\n        [ngClass]=\"cid ? 'btn-primary' : 'btn-success'\"\r\n        [disabled]=\"!courseAddForm.valid || waitingForApi\"\r\n        [innerHtml]=\"cid ? 'Update' : 'Create'\"\r\n      ></button>\r\n      <a type=\"button\" class=\"text-primary\" [routerLink]=\"['/admin', 'publisher', 'courses']\">\r\n        Return to your course directory\r\n      </a>\r\n\r\n    </form>\r\n\r\n  </div>\r\n\r\n  <div class=\"container border border-rounded border-secondary my-4\" *ngIf=\"cid\">\r\n    <div class=\"row\">\r\n      <div class=\"col m-4\">\r\n        <div class=\"h5\">Danger zone</div>\r\n        <div class=\"lead my-3\">Irreversible action - don't do it.</div>\r\n        <button class=\"btn btn-danger\" (click)=\"deleteCourseBtn()\">Delete</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n","import { Component, OnInit } from '@angular/core'\r\nimport { FadeInOut } from 'src/app/core/animations/fade-in-out.animation'\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms'\r\nimport { HttpClient } from '@angular/common/http'\r\nimport { MatSnackBar } from '@angular/material/snack-bar'\r\n\r\n// WNGX imports\r\nimport { ConfigService } from 'src/app/core/services/config/config.service'\r\nimport { Course } from 'src/app/models/course.model'\r\nimport { ActivatedRoute, Router } from '@angular/router'\r\nimport { CourseService } from 'src/app/pages/catalogue/course/course.service'\r\nimport { DeleteCourseService } from '../components/delete-course/delete-course.service'\r\n\r\n@Component({\r\n  selector: 'app-course',\r\n  templateUrl: './course.component.html',\r\n  styleUrls: ['./course.component.scss'],\r\n  animations: [FadeInOut]\r\n})\r\n\r\nexport class CourseComponent implements OnInit {\r\n\r\n  public courseAddForm: FormGroup\r\n  public course = new Course\r\n  public hideAdvanced = true\r\n  public waitingForApi = false\r\n\r\n  constructor(\r\n    public fb: FormBuilder,\r\n    private httpClient: HttpClient,\r\n    private activatedRoute: ActivatedRoute,\r\n    private router: Router,\r\n    private _snackbar: MatSnackBar,\r\n    private courseService: CourseService,\r\n    private configService: ConfigService,\r\n    public deleteCourseService: DeleteCourseService\r\n  ) {\r\n    this.courseAddForm = this.fb.group({\r\n      title: ['', Validators.compose(\r\n        [\r\n          Validators.required,\r\n          Validators.minLength(16),\r\n          Validators.maxLength(128),\r\n          Validators.pattern('\\\\s?\\\\S+(?: \\\\S+)*\\\\s?') // no consec spaces\r\n        ])],\r\n      short_desc: ['', Validators.compose(\r\n        [\r\n          Validators.required,\r\n          Validators.minLength(32),\r\n          Validators.maxLength(256),\r\n          Validators.pattern('\\\\s?\\\\S+(?: \\\\S+)*\\\\s?') // no consec spaces\r\n        ])],\r\n      price: [20, Validators.compose(\r\n        [\r\n          Validators.required,\r\n          Validators.min(0),\r\n          Validators.max(99999),\r\n          Validators.pattern(\"^[0-9]*$\")\r\n        ]\r\n      )],\r\n      private: '',\r\n      audience: '',\r\n      long_desc: '',\r\n      objective: '',\r\n      eval_type: '',\r\n    })\r\n  }\r\n\r\n  ngOnInit() {\r\n    if (this.cid) {\r\n      this.courseService.getAdminCourse(this.cid).subscribe(\r\n        (course: Course) => {\r\n          this.course = course\r\n          this.courseAddForm.patchValue(course)\r\n          this.courseAddForm.controls.price.patchValue(course.price / 100)\r\n        }\r\n      )\r\n    }\r\n  }\r\n\r\n  onSubmit(): void {\r\n    this.waitingForApi = true\r\n    this.httpClient.post<Course>(\r\n      `${this.configService.params.api.route}/admin/publisher/courses`,\r\n      this.courseAddForm.value\r\n    ).subscribe(\r\n      (course: Course) => {\r\n        this.router.navigate(['/admin', 'publisher', 'builder', 'sorry'])\r\n      },\r\n      (err) => {\r\n        // it looks like the function in third () => {} does not get called when err is received\r\n        this.waitingForApi = false\r\n      },\r\n      () => { this.waitingForApi = false }\r\n    )\r\n  }\r\n\r\n  onUpdate() {\r\n    this.waitingForApi = true\r\n    this.courseAddForm.value.price = this.courseAddForm.value.price * 100\r\n    this.httpClient.patch<Course>(\r\n      `${this.configService.params.api.route}/admin/publisher/courses/${this.cid}`,\r\n      this.courseAddForm.value\r\n    ).subscribe(\r\n      (course: Course) => {\r\n        this.course = course\r\n        this.snackbarNotify('Course updated.')\r\n      },\r\n      (err) => { this.snackbarNotify('Failed to update course.') },\r\n      () => { this.waitingForApi = false }\r\n    )\r\n  }\r\n\r\n  deleteCourseBtn() {\r\n    this.deleteCourseService.deleteCourseModal(this.course)\r\n  }\r\n\r\n  snackbarNotify(message: string) {\r\n    this._snackbar.open(message, '', {\r\n      duration: 3000\r\n    })\r\n  }\r\n\r\n  get cid() {\r\n    return this.activatedRoute.snapshot.paramMap.get('cid')\r\n  }\r\n\r\n}\r\n","import { NgModule } from '@angular/core'\r\nimport { RouterModule, Routes } from '@angular/router'\r\nimport { CourseComponent } from './course.component'\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: CourseComponent,\r\n    title: 'Build a new course (Cultivate Learning)'\r\n  },\r\n  {\r\n    path: 'edit/:cid',\r\n    component: CourseComponent,\r\n    title: 'Edit Course (Cultivate Learning)'\r\n  }\r\n]\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\n\r\nexport class CourseRoutingModule { }\r\n","import { NgModule } from '@angular/core'\r\nimport { CommonModule } from '@angular/common'\r\nimport { ReactiveFormsModule } from '@angular/forms'\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap'\r\nimport { MatButtonModule } from '@angular/material/button'\r\nimport { MatSnackBarModule } from '@angular/material/snack-bar'\r\n\r\nimport { CourseRoutingModule } from './course-routing.module'\r\nimport { CourseComponent } from './course.component'\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    CourseComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    ReactiveFormsModule,\r\n    NgbModule,\r\n    MatButtonModule,\r\n    MatSnackBarModule,\r\n    CourseRoutingModule,\r\n  ]\r\n})\r\nexport class CourseModule { }\r\n"],"x_google_ignoreList":[]}